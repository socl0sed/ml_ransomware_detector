Вирус шифровальщик (Ransomware) - тип вредоносного ПО, который при помощи алгоритмов шифрования модифицирует файлы пользователя так, что доступ к ним нельзя получить без использования специальной программы - декриптора

## Как происходит атака

**Векторы атак**, используемые троянами-вымогателями, включают, в основном, **протокол удаленного рабочего стола**, **фишинговые сообщения электронной почты** и **уязвимости программного обеспечения**. Таким образом, атака программ-вымогателей может быть нацелена как на **частных лиц**, так и на **компании**.

[[https://www.checkpoint.com/cyber-hub/threat-prevention/ransomware/]] 

**Step 1 Infection and Distribution Vectors:** 

Программы-вымогатели, как и любое вредоносное ПО, могут получить доступ к системам организации различными способами. Тем не менее, операторы программ-вымогателей, как правило, предпочитают несколько специфических переносчиков инфекции.

Одним из них является фишинговые электронные письма. Вредоносное электронное письмо может содержать ссылку на веб-сайт, на котором размещена вредоносная загрузка, или вложение, в которое встроена функция загрузки. Если получатель электронной почты попадается на фишинг, то программа-вымогатель загружается и выполняется на его компьютере.

Другой популярный вектор инфекции программ-вымогателей использует такие сервисы, как протокол удаленного рабочего стола (RDP). С помощью RDP злоумышленник, который украл или угадал учетные данные сотрудника, может использовать их для аутентификации и удаленного доступа к компьютеру в корпоративной сети. С помощью этого доступа злоумышленник может напрямую загрузить вредоносное ПО и запустить его на контролируемом им компьютере.

Другие могут пытаться напрямую заразить системы, например, как WannaCry использовал уязвимость EternalBlue. Большинство вариантов программ-вымогателей имеют несколько infection vectors. *(перевод корявый, но суть в целом понятна)*

**Step 2 Data Encryption:**

После того, как программы-вымогатели получили доступ к системе, они могут начать шифровать свои файлы. Поскольку функция шифрования встроена в операционную систему, это просто включает в себя доступ к файлам, их шифрование с помощью ключа, управляемого злоумышленником, и замену оригиналов зашифрованными версиями. Большинство вариантов программ-вымогателей осторожно относятся к выбору файлов для шифрования для обеспечения стабильности системы. Некоторые варианты также предпримут шаги по удалению резервных и теневых копий файлов, чтобы затруднить восстановление без ключа расшифровки.

*P.S: короче трындец вашим резервным копиям фотографий своего котейки, поэтому самое важное всегда надо хранить в облаке. Многие шифровальщики довольно умно шифруют файлики таким образом, что вы и не заметите утраты до определенного момента*

**Step 3 Ransom Demand:**

После завершения шифрования файлов программа-вымогателя готова выдать требование о выкупе. Различные варианты программ-вымогателей реализуют это различными способами, но нередко фон дисплея меняется на записку о выкупе или текстовые файлы, помещенные в каждый зашифрованный каталог, содержащий записку о выкупе. Как правило, эти банкноты требуют определенного количества криптовалюты в обмен на доступ к файлам жертвы. Если выкуп выплачивается, оператор программ-вымогателей либо предоставит копию закрытого ключа, используемого для защиты симметричного ключа шифрования, либо копию самого симметричного ключа шифрования. Эта информация может быть введена в программу дешифрования (также предоставленную киберпреступником), которая может использовать ее для отмены шифрования и восстановления доступа к файлам пользователя.

Хотя эти три основных шага существуют во всех вариантах программ-вымогателей, различные программы-вымогатели могут включать в себя разные реализации или дополнительные шаги. Например, такие варианты программ-вымогателей, как Maze, выполняют сканирование файлов, информацию реестра и кражу данных перед шифрованием данных, а WannaCry сканирует другие уязвимые устройства для заражения и шифрования.

*Симметричный ключ - ключ, который используется и для шифрование и для дешифровки. То есть более со стороны преступника более умно скрывать этот симметричный ключ, дабы его вирус не был одноразовым (ну как я понял -_-)*

## Типы шифровальщиков

[[https://www.kaspersky.ru/resource-center/threats/ransomware-attacks-and-types]]

Наиболее популярны два типа программ вымогателей:
- **Программы - блокировщики с требованием выкупа.** Этот тип вредоносных программ **блокирует основные функции компьютера**. Например, может быть ограничен доступ к рабочему столу, а мышь и клавиатура могут быть частично отключены, что позволяет взаимодействовать с окном, содержащим требование выкупа, и произвести платеж. Кроме того, может быть выведен из строя компьютер. Но есть и хорошие новости: вредоносные программы - блокировщики обычно не нацелены на важные файлы; их цель – просто заблокировать ваше устройство. Поэтому полное уничтожение ваших данных маловероятно.
- **Вредоносные программы-шифровальщики.** Цель таких программ-вымогателей – зашифровать важные данные, такие как документы, изображения и видео, но **не вмешиваться в основную работу компьютера**. Это часто вызывает панику, поскольку пользователи видят файлы, но не могут получить к ним доступ. Разработчики таких программ часто добавляют к требованию выкупа обратный отсчет: «Если вы не заплатите выкуп до установленного срока, все ваши файлы будут удалены». Учитывая количество пользователей, не знающих о необходимости создания резервных копий данных в облачных хранилищах или на внешних физических устройствах, атаки программ-шифровальщиков могут иметь крайне негативные последствия. Поэтому многие жертвы платят выкуп просто для того, чтобы вернуть свои файлы.

## Типы атак 

- **Double Extortion (двойное вымогательство)** Шифрует и крадет данные. Если пользователь отказывается платить за расшифровку, грозит слить данные.
- **Triple Extortion** Такая же фигня как и предыдущая, но + грозит еще и DDOSом
- **Locker Ransomware** Не шифрует файлы, а тупо блочит комп / делает его не юзабельным, пока жертва не заплатит
- **Crypro Ransomware** Рансомваре, который требует выкуп в крипте ибо операции с ней труднее отследить *(ну все-таки странно писать требования об оплате с репликой "Сбер: +7-985-... Никита Сергеевич В, можно через СБП")*
- [**Wiper**](https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-malware/what-is-wiper-malware/) Стремная хрень. Шифрует файлы и удаляет единственную копию ключа шифрования, что делает расшифровку невозможной.
- [**Ransomware as a Service (RaaS)**](https://www.checkpoint.com/cyber-hub/threat-prevention/ransomware/ransomware-as-a-service-raas/) Вирус, который с радостью поделится доступом к вашим данным с другими вирусами. Делят выкуп на всех и пируют
- **Data-Stealing Ransomware** Сосредоточен больше на краже данных, нежели на их шифровке, так как шифрование весьма трудоемкий и легко обнаруживаемый процесс, с которым компании могут и умеют бороться

## Известные вирусы шифровальщики

*Поехали...*

1. [Ryuk](https://www.checkpoint.com/cyber-hub/threat-prevention/ransomware/ryuk-ransomware/)
   Ryuk является примером очень целенаправленного варианта программ-вымогателей. Он обычно доставляется через фишинговые электронные письма или с использованием скомпрометированных учетных данных пользователя для входа в корпоративные системы с использованием протокола удаленного рабочего стола (RDP). Как только система заражена, Рюк шифрует определенные типы файлов (избегая тех, которые имеют решающее значение для работы компьютера), а затем предъявляет требование о выкупе. 
   Ryuk хорошо известен как один из самых дорогих видов программ-вымогателей. Рюк требует выкуп, которые в среднем составляют более 1 миллиона долларов. В результате киберпреступники, стоящие за Рюком, в первую очередь сосредоточены на предприятиях, которые имеют ресурсы, необходимые для удовлетворения их потребностей.

2. [Maze](https://www.checkpoint.com/cyber-hub/threat-prevention/ransomware/maze-ransomware-double-extortion-attack/)
   Программа-вымогатель Maze известна тем, что является первым вариантом программ-вымогателей, который сочетает в себе шифрование файлов и кражу данных. Когда цели начали отказываться платить выкуп, Мэйз начал собирать конфиденциальные данные с компьютеров жертв, прежде чем зашифровать их. Если требования о выкупе не будут выполнены, эти данные будут публично раскрыты или проданы тому, кто предложит самую высокую цену. Потенциал дорогостоящей утечки данных был использован в качестве дополнительного стимула для оплаты. 
   Группа, стоящая за программой-вымогателем Maze, официально прекратила свою деятельность. Однако это не означает, что угроза программ-вымогателей была снижена. Некоторые филиалы Maze перешли на использование программ-вымогателей Egregor, и считается, что варианты Egregor, Maze и Sekhmet имеют общий источник.

3. REvil (Sodinokibi)
   Группа REvil (также известная как Sodinokibi) - это еще один вариант программ-вымогателей, нацеленный на крупные организации.
   REvil - одно из самых известных семейств программ-вымогателей в сети. Группа программ-вымогателей, которая с 2019 года управляется русскоязычной группой REvil, несет ответственность за многие крупные нарушения, такие как «Kaseya» и «JBS»
   В течение последних нескольких лет он конкурировал с Рюком за звание самого дорогого варианта программ-вымогателей. Известно, что REvil потребовала выкуп в размере 800 000 долларов США.
   В то время как REvil начинался как традиционный вариант программ-вымогателей, он развивался с течением времени
   Они используют технику двойного вымогательства - для кражи данных у предприятий, а также шифрования файлов. Это означает, что, помимо требования выкупа за расшифровку данных, злоумышленники могут угрожать выпустить украденные данные, если второй платеж не будет произведен.

4. Lockbit
   LockBit - это вредоносное ПО для шифрования данных, работающее с сентября 2019 года, и недавнее программное обеспечение Ransomware-as-a-Service (RaaS). Эта часть программ-вымогателей была разработана для быстрого шифрования крупных организаций в качестве способа предотвращения ее быстрого обнаружения устройствами безопасности и IT/SOC-командами.

5. DearCry
   В марте 2021 года Microsoft выпустила исправления для четырех уязвимостей на серверах Microsoft Exchange. DearCry - это новый вариант программ-вымогателей, предназначенный для использования преимуществ четырех недавно раскрытых уязвимостей в Microsoft Exchange
   Программа-вымогатель DearCry шифрует определенные типы файлов. После завершения шифрования DearCry покажет сообщение о выкупе, в котором пользователи должны отправить электронное письмо операторам программ-вымогателей, чтобы узнать, как расшифровать их файлы.

6. Lapsus$
   Lapsus$ - это южноамериканская банда программ-вымогателей, которая была связана с кибератаками на некоторые громкие цели. Кибербанда известна тем, что вымогает, угрожая выпустить конфиденциальную информацию, если требования ее жертв не будут сделаны. Группа хвасталась прорывом в Nvidia, Samsung, Ubisoft и другие. Группа использует украденный исходный код, чтобы замаскировать файлы вредоносных программ как заслуживающие доверия.

## Техническая составляющая вируса

Как правило вирусы-шифровальщики обычно выбирают определенные типы файлов для шифровки. Это делается путем сканирования файловой системы и выбора файлов с определенным расширением.

Затем вирус использует различные алгоритмы шифрования, как правило, довольно сильные, такие как AES (Advanced Encryption Standard). Эти алгоритмы обеспечивают высокий уровень безопасности, делая невозможным расшифровку без ключа.

Вирус генерирует ключ шифрования, который либо хранится в зашифрованном виде на устройстве жертвы, либо отправляется злоумышленнику.

Вирус применяет алгоритм шифрования к выбранным файлам, заменяя оригинальное содержимое файла на зашифрованное. **После шифрования файлы могут быть переименованы или иметь добавленное расширение, чтобы указать на то, что они расшифрованы.** *(думаю, это важная деталь)*

Вирусы-шифровальщики часто реализуются в виде скриптов или исполняемых файлов, которые могут быть запущены на различных платформах (Windows, macOS, Linux).

Вирусы могут использовать методы скрытия и маскировки, чтобы избежать обнаружения антивирусными программами. Например, они могут менять свои сигнатуры или использовать обфускацию кода.

*Сигнатура вируса - это **уникальная последовательность байтов, принадлежащая вирусу и не встречающаяся в других программах**. Определение сигнатуры вируса очень сложная задача. Необходимо тщательно изучить принцип работы вируса и сравнить программы, зараженные данным вирусом, и незараженные.*

*Обфускация кода — это **процесс, в результате которого приложения становится трудно или невозможно декомпилировать или дизассемблировать, а извлеченный код приложения становится более трудным для анализа людьми***

Некоторые вирусы-шифровальщики могут иметь механизм обратной связи с сервером злоумышленников, чтобы отправлять информацию о зараженных устройствах, получать инструкции или ключи для расшифровки.

## Как же с шифровальщиком борется антивирус

1. Сигнатурный анализ
   - **Определение сигнатур:** Антивирус сканирует файлы и процессы на устройстве, сравнивая их с базой известных сигнатур вредоносного ПО. Если обнаруживается совпадение, антивирус помечает файл как вредоносный.
   - **Обновление базы сигнатур:** Для эффективной работы антивирусные программы регулярно обновляют свою базу сигнатур, чтобы обнаруживать новые и модифицированные вирусы-шифровальщики.
2. Поведенческий анализ
   - **Мониторинг поведения:** Антивирус отслеживает поведение процессов и файлов на устройстве. Если обнаруживается подозрительное поведение, такое как попытка шифрования файлов или изменение системных файлов, антивирус может пометить этот процесс как потенциально вредоносный.
   - ==**Искусственный интеллект и машинное обучение:** Некоторые современные антивирусные программы используют искусственный интеллект и машинное обучение для анализа поведения и выявления новых угроз, которые не были известны ранее.==
3. Эвристатический анализ
   - **Анализ кода:** Антивирус анализирует код программ и скриптов на наличие известных вредоносных паттернов и техник, таких как использование криптографических алгоритмов для шифрования данных.
   - **Обфускация и декомпиляция:** Антивирус может использовать методы декомпиляции и деобфускации для анализа запутанного кода и выявления вредоносных функций.
4. Проактивная защита
   - **Защита от загрузки:** Антивирус может блокировать загрузку и выполнение подозрительных файлов, которые могут содержать вирусы-шифровальщики.
   - **Защита в реальном времени:** Антивирус постоянно отслеживает активность на устройстве и блокирует попытки вредоносного ПО выполнить вредоносные действия.
5. Обнаружение и блокировка сетевых угроз
   - **Блокировка C&C-серверов:** Антивирус может блокировать подключения к командно-контрольным серверам (C&C), которые используются вирусами-шифровальщиками для получения инструкций и ключей для расшифровки данных.
   - **Фильтрация сетевого трафика:** Антивирус может фильтровать сетевой трафик на устройстве, блокируя подозрительные запросы и подключения.
6. Реагирование на инциденты
   - **Автоматическое восстановление:** В некоторых случаях антивирус может автоматически восстанавливать зашифрованные файлы, используя резервные копии или известные методы расшифровки.
   - **Уведомление пользователя:** Антивирус может уведомлять пользователя о подозрительной активности и предоставлять инструкции по дальнейшим действиям.
7. Профилактика и обучение
   - Учит основам инфобеза по типу не тыкать на всякие стремные ссылки и не вводить данные своих или корпоративных аккаунтов туда, куда их вводить не стоит
8. Использование облачных технологий
   - **Облачный анализ:** Некоторые антивирусные программы используют облачные технологии для анализа подозрительных файлов и URL-адресов. Это позволяет быстро обнаруживать новые угрозы и предотвращать их распространение.
   - **Облачная база данных:** Облачная база данных антивируса может быть более быстро обновляемой и содержать больше информации о новых угрозах, чем локальная база данных.
9. Использование брандмауэров и VPN
   - **Брандмауэр:** Брандмауэр может блокировать подозрительные сетевые подключения, которые могут использоваться для распространения вирусов-шифровальщиков.
   - **VPN**: Использование VPN может скрыть ваш IP-адрес и защитить ваш сетевой трафик от перехвата и анализа злоумышленниками. *(выходит мы все теперь капец какие безопасные когда ютубчик смотрим xD)*
10. Резервное копирование и восстановление
     - **Резервное копирование:** Регулярное создание резервных копий данных и их хранение в безопасном месте.
     - **Восстановление данных:** В случае заражения вирусом-шифровальщиком, восстановление данных из резервных копий может быть единственным способом восстановить доступ к зашифрованным файлам.
## Решение нашей задачи
Итак, теперь как же нам с помощью МО справиться с этим быдлом по шагам:
1. Собираем датасеты (базы данных с кучей зараженных и чистых файлов, чем больше, тем лучше) и занимаемся разметкой данных
   Датасетов с шифровальщиком на просторах интернета довольно много, я уже нашел несколько, надо только выбрать: 
   [[https://rissgroup.org/ransomware-dataset/]
   [[https://www.kaggle.com/datasets/amdj3dax/ransomware-detection-data-set]
   [[https://www.kaggle.com/datasets/joebeachcapital/ransomware-attacks]
   [[https://github.com/manabu-hirano/RanSAP]
2. Обрабатываем все, что надыбали
   **Извлечение признаков:** Извлекаем признаки из файлов, которые могут помочь в обнаружении вирусов. Например:
   - **Статистические признаки:** Среднее значение, дисперсия, энтропия байтов в файле.
   - **Фрагменты кода:** Извлечение фрагментов кода из исполняемых файлов (например, используя дизассемблер).
   - **Метаданные:** Информация о файле, такую как размер, расширение, дата создания и модификации.
   - **Бинарные признаки:** Использование бинарных представлений файлов (например, битовые строки).
3. Выбираем модель машинного обучения
   - **Деревья решений:** Простые и интерпретируемые модели.
   - **Случайные леса:** Более сложные модели, которые могут улучшить точность.
   - **Градиентный бустинг:** Алгоритмы, такие как XGBoost, LightGBM, которые могут обеспечить высокую точность.
   - **Нейронные сети:** Для более сложных задач можно использовать нейронные сети, особенно если данные имеют сложную структуру.
4. Обучаем модельку
   - **Разделение данных:** Делим данные на обучающую и тестовую выборки. Обычно используется соотношение 70/30 или 80/20.
   - **Обучение:** Обучаем модель на обучающей выборке, используя выбранный алгоритм.
   - **Оценка:** Оцениваем модель на тестовой выборке, используя метрики, такие как точность, полнота, F1-мера и ROC-AUC.
5. Оптимизируем
   Ну что тут скажешь... Родили однажды, родим и дважды...
6. Развертывание и мониторинг
   - **Развертывание:** Юзаем модель в реальной среде, где она будет использоваться для обнаружения вирусов-шифровальщиков.
   - **Мониторинг:** Регулярно чекаем производительность модели и обновляйте ее по мере необходимости, добавляя новые данные и улучшая алгоритмы.

Для обучения модели данных должно быть очень много и их нужно постоянно обновлять и пополнять, дабы модель могла справляться с новыми видами угроз, ведь **враг не дремлет**!